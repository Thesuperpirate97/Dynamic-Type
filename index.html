<!DOCTYPE html>
<html>
<head>
  <title>Type Race</title>
  <style>
    body {
      margin:0;
      font-family:Arial, sans-serif;
      text-align:center;
      color:white;
      background: linear-gradient(to bottom, #222, #555);
      background-attachment: fixed;
    }
    canvas {
      border:2px solid black;
      display:block;
      margin:20px auto;
      background:#eee;
    }
    .menu button {
      margin:10px;
      padding:10px 20px;
      font-size:18px;
      border-radius:8px;
      border:none;
      background:#ff4c4c;
      color:white;
      cursor:pointer;
      font-weight:bold;
    }
    .menu button:hover { background:#cc0000; }

    .garage-car, .shop-car {
      display:inline-block;
      margin:10px;
      padding:10px;
      border:2px solid black;
      cursor:pointer;
      position:relative;
      background:white;
    }
    .selected { border:3px solid gold; }

    /* Cool car background */
    body::before {
      content: "🚗 🚙 🏎️ 🚕 ";
      position: fixed;
      top: -50px;
      left: 0;
      width: 100%;
      height: 100%;
      font-size: 60px;
      color: rgba(255,255,255,0.1);
      white-space: nowrap;
      animation: moveCars 30s linear infinite;
      pointer-events: none;
    }
    @keyframes moveCars {
      from { transform: translateX(0); }
      to { transform: translateX(-100%); }
    }

    /* Admin Panel */
    #adminToggle {
      position: fixed;
      right: 10px;
      top: 50px;
      width: 40px;
      height: 40px;
      background: gold;
      border-radius: 50%;
      font-size: 20px;
      font-weight: bold;
      cursor: pointer;
      display: none;
    }
    #adminPanel {
      position: fixed;
      right: 10px;
      top: 100px;
      width: 180px;
      background: #222;
      color: white;
      padding: 10px;
      border-radius: 10px;
      display: none;
      text-align:left;
    }
    #adminPanel button {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 8px;
      background: crimson;
      border: none;
      color: white;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
    }
    #adminPanel button:hover {
      background: darkred;
    }
  </style>
</head>
<body>
  <h1>🏎️ Type Race 🏎️</h1>
  <div id="menu" class="menu">
    <button onclick="showRace()">Start Race</button>
    <button onclick="showGarage()">Garage</button>
    <button onclick="showShop()">Shop</button>
    <button onclick="showProfile()">Profile</button>
  </div>

  <canvas id="gameCanvas" width="800" height="400" style="display:none;"></canvas>
  <div id="wordBox" style="display:none;">
    <p id="word"></p>
    <input id="typeBox" type="text" autocomplete="off"/>
    <p id="result"></p>
  </div>

  <div id="garage" style="display:none;">
    <h2>Garage</h2>
    <div id="carOptions"></div>
    <button onclick="backToMenu()">Back</button>
  </div>

  <div id="shop" style="display:none;">
    <h2>Shop</h2>
    <div id="shopOptions"></div>
    <p>Coins: <span id="coins"></span></p>
    <button onclick="backToMenu()">Back</button>
  </div>

  <div id="profile" style="display:none;">
    <h2>Profile</h2>
    <p>Name: <input id="nameInput" type="text" /></p>
    <button onclick="saveName()">Save</button>
    <button onclick="backToMenu()">Back</button>
  </div>

  <!-- Admin Panel -->
  <button id="adminToggle" onclick="toggleAdmin()">⚡</button>
  <div id="adminPanel">
    <h3>⚡ Admin Panel ⚡</h3>
    <button onclick="adminWinRace()">🏁 Instant Win</button>
    <button onclick="adminUnlockCars()">🚗 Unlock All Cars</button>
    <button onclick="adminInfiniteCoins()">💰 Infinite Coins</button>
  </div>

  <script>
  const $ = id => document.getElementById(id);

  let state = {
    name: "Player",
    coins: 0,
    unlocked: ["red"],
    selectedCar: "red"
  };

  const cars = [
    {id:"red", color:"red", price:0},
    {id:"blue", color:"blue", price:50},
    {id:"green", color:"green", price:100},
    {id:"yellow", color:"yellow", price:200},
    {id:"admin", color:"black", price:0}
  ];

  let adminCarImg = new Image();
  adminCarImg.src = "car.png";

  // English dictionary long words
  const words = [
    "extraordinary","imagination","responsibility","characteristic",
    "contribution","unbelievable","environmental","organization",
    "computerization","communication","understanding","relationship",
    "interpretation","consideration","determination","availability"
  ];

  function save(){ localStorage.setItem("typerace", JSON.stringify(state)); }
  function load(){ let s = localStorage.getItem("typerace"); if(s) state = JSON.parse(s); }
  load();

  function backToMenu(){
    $("gameCanvas").style.display="none";
    $("wordBox").style.display="none";
    $("garage").style.display="none";
    $("shop").style.display="none";
    $("profile").style.display="none";
    $("menu").style.display="block";
  }

  let phrases = [];
  let currentIndex = 0;
  let playerX = 40, botX = 40, finish = 720, raceOver = false;

  function showRace(){
    $("menu").style.display="none";
    $("gameCanvas").style.display="block";
    $("wordBox").style.display="block";
    startRace();
  }

  function startRace(){
    phrases = [
      words[Math.floor(Math.random()*words.length)],
      words[Math.floor(Math.random()*words.length)]
    ];
    currentIndex = 0;
    $("word").textContent = phrases[currentIndex];
    $("typeBox").value = "";
    $("result").textContent = "";
    playerX = 40; botX = 40; raceOver = false;
    draw();
    botRace();
  }

  $("typeBox").addEventListener("input", ()=>{
    if(raceOver) return;
    if($("typeBox").value.trim() === phrases[currentIndex]){
      playerX += 300;
      $("typeBox").value = "";
      currentIndex++;
      if(currentIndex < phrases.length){
        $("word").textContent = phrases[currentIndex];
      } else {
        $("result").textContent = "You finished! 🎉";
        state.coins += 20;
        save();
        raceOver = true;
      }
      draw();
    }
  });

  function botRace(){
    let botIndex = 0;
    function step(){
      if(raceOver) return;
      if(botIndex < phrases.length){
        botX += 300;
        botIndex++;
        draw();
        if(botIndex === phrases.length){
          $("result").textContent = "Bot finished! 😢";
          raceOver = true;
          return;
        }
        setTimeout(step, 2000 + Math.random()*2000);
      }
    }
    setTimeout(step, 3000);
  }

  function draw(){
    let ctx = $("gameCanvas").getContext("2d");
    ctx.clearRect(0,0,800,400);
    ctx.fillStyle = "gray";
    ctx.fillRect(0,150,800,100);

    let car = cars.find(c=>c.id===state.selectedCar);
    if(car.id === "admin"){
      ctx.drawImage(adminCarImg, playerX, 160, 60, 30);
    } else {
      ctx.fillStyle = car.color;
      ctx.fillRect(playerX, 160, 60, 30);
    }

    ctx.fillStyle = "purple";
    ctx.fillRect(botX, 200, 60, 30);

    ctx.fillStyle = "black";
    ctx.fillRect(finish, 150, 10, 100);
  }

  function showGarage() {
    $("menu").style.display="none";
    $("garage").style.display="block";
    $("carOptions").innerHTML = "";
    cars.forEach(car => {
      let c = document.createElement("div");
      c.className = "garage-car";
      if (car.id === state.selectedCar) c.classList.add("selected");

      if (car.id === "admin") {
        let img = document.createElement("img");
        img.src = adminCarImg.src;
        img.width = 60; img.height = 30;
        if (state.name !== "ownedkid") {
          img.style.filter = "grayscale(100%) opacity(60%)";
          c.appendChild(img);
          let lock = document.createElement("div");
          lock.style.position="absolute"; lock.style.width="60px"; lock.style.height="30px";
          lock.style.background="rgba(0,0,0,0.5)";
          lock.style.display="flex"; lock.style.alignItems="center"; lock.style.justifyContent="center";
          lock.style.color="white"; lock.style.fontWeight="bold"; lock.textContent="🔒";
          c.style.position="relative"; c.appendChild(lock);
        } else {
          c.appendChild(img);
          c.onclick = () => { state.selectedCar = car.id; save(); showGarage(); };
        }
      } else if (state.unlocked.includes(car.id)) {
        c.style.background = car.color;
        c.style.width="60px"; c.style.height="30px";
        c.onclick = () => { state.selectedCar = car.id; save(); showGarage(); };
      }
      $("carOptions").appendChild(c);
    });
  }

  function showShop() {
    $("menu").style.display="none";
    $("shop").style.display="block";
    $("shopOptions").innerHTML = "";
    $("coins").textContent = state.coins;
    cars.forEach(car => {
      let c = document.createElement("div");
      c.className = "shop-car";
      if (car.id === "admin") {
        let img = document.createElement("img");
        img.src = adminCarImg.src; img.width=60; img.height=30;
        if (state.name !== "ownedkid") {
          img.style.filter = "grayscale(100%) opacity(60%)";
          c.appendChild(img); let txt=document.createElement("p");
          txt.textContent="Admin Supercar 🔒"; c.appendChild(txt);
        } else {
          c.appendChild(img); let txt=document.createElement("p");
          txt.textContent="Admin Supercar (free)"; c.appendChild(txt);
          let btn=document.createElement("button");
          btn.innerText="Select";
          btn.onclick=()=>{ state.selectedCar="admin"; save(); alert("Admin Supercar equipped!"); };
          c.appendChild(btn);
        }
        $("shopOptions").appendChild(c); return;
      }
      if (!state.unlocked.includes(car.id)) {
        let box=document.createElement("div");
        box.style.width="60px"; box.style.height="30px"; box.style.background=car.color; box.style.border="2px solid black";
        c.appendChild(box);
        let txt=document.createElement("p");
        txt.textContent=car.id+" - "+car.price+" coins"; c.appendChild(txt);
        let btn=document.createElement("button");
        btn.innerText="Buy";
        btn.onclick=()=>{
          if(state.coins>=car.price){ state.coins-=car.price; state.unlocked.push(car.id); save(); showShop(); }
          else alert("Not enough coins!");
        };
        c.appendChild(btn);
        $("shopOptions").appendChild(c);
      }
    });
  }

  function showProfile(){
    $("menu").style.display="none";
    $("profile").style.display="block";
    $("nameInput").value = state.name;
  }
  function saveName(){
    state.name = $("nameInput").value.trim() || "Player";
    save(); alert("Name saved!"); checkAdminPanel();
  }

  function checkAdminPanel() {
    if (state.name === "SupaRed") {
      $("adminToggle").style.display = "block";
    } else {
      $("adminToggle").style.display = "none";
      $("adminPanel").style.display = "none";
    }
  }
  function toggleAdmin() {
    $("adminPanel").style.display = $("adminPanel").style.display==="none" ? "block" : "none";
  }
  function adminWinRace() {
    if (!raceOver) {
      playerX = finish - 60; $("result").textContent = "Admin Win! 🎉";
      state.coins += 50; save(); raceOver = true; draw();
    }
  }
  function adminUnlockCars() { state.unlocked = cars.map(c=>c.id); save(); alert("All cars unlocked!"); }
  function adminInfiniteCoins() { state.coins = 999999; save(); alert("Infinite coins!"); if($("coins")) $("coins").textContent=state.coins; }

  checkAdminPanel();
  </script>
</body>
</html>
