<!DOCTYPE html>
<html>
<head>
  <title>Type Race</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      text-align: center;
      color: white;
      background: linear-gradient(to bottom, #0f0f0f, #1a1a1a);
      background-image: url("https://i.imgur.com/x5Xy4Fm.jpg"); /* clean car bg */
      background-size: cover;
      background-attachment: fixed;
      background-position: center;
    }

    h1 {
      font-size: 48px;
      margin-top: 20px;
      text-shadow: 2px 2px 6px black;
    }

    #menu, #garage, #shop, #race { display: none; }

    button {
      padding: 12px 25px;
      margin: 10px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      border: none;
      background: #0077cc;
      color: white;
      transition: 0.2s;
    }
    button:hover { background: #005fa3; }

    #gameCanvas {
      background: #ddd;
      display: block;
      margin: 20px auto;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }

    .garage-car {
      width: 60px;
      height: 30px;
      margin: 10px;
      display: inline-block;
      border: 2px solid #333;
      cursor: pointer;
      border-radius: 4px;
    }
    .selected { border: 3px solid gold; }

    /* Admin panel */
    #adminPanel {
      position: fixed;
      right: 20px;
      top: 80px;
      width: 200px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 12px;
      border-radius: 12px;
      display: none;
      text-align: left;
    }
    #adminPanel h3 { text-align: center; }
    #adminPanel button {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 8px;
      background: crimson;
      border-radius: 6px;
    }
    #adminPanel button:hover { background: darkred; }

    /* Return button */
    #returnBtn {
      margin-top: 20px;
      padding: 12px 25px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      display: none;
    }
    #returnBtn:hover { background: #1e7e34; }

    /* Input field */
    input {
      padding: 8px;
      font-size: 16px;
      border-radius: 6px;
      border: none;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>üöó Type Race üöó</h1>

  <div id="menu">
    <h2>Main Menu</h2>
    <button onclick="showGarage()">Garage</button>
    <button onclick="showShop()">Shop</button>
    <button onclick="startRace()">Race</button>
    <br><br>
    <input id="nameInput" placeholder="Enter your name">
    <button onclick="saveName()">Save Name</button>
    <p id="coins">Coins: 0</p>
  </div>

  <div id="garage">
    <h2>Garage</h2>
    <div id="carOptions"></div><br>
    <button onclick="backToMenu()">Back</button>
  </div>

  <div id="shop">
    <h2>Shop</h2>
    <div id="shopOptions"></div><br>
    <button onclick="backToMenu()">Back</button>
  </div>

  <div id="race">
    <canvas id="gameCanvas" width="800" height="400"></canvas>
    <p id="phrase"></p>
    <input id="typeInput" placeholder="Type here" oninput="checkTyping()">
    <p id="result"></p>
    <button id="returnBtn" onclick="returnToMenu()">‚¨Ö Return to Menu</button>
  </div>

  <div id="adminPanel">
    <h3>‚ö° Admin Panel ‚ö°</h3>
    <button onclick="adminWinRace()">üèÅ Instant Win</button>
    <button onclick="adminUnlockCars()">üöó Unlock All Cars</button>
    <button onclick="adminInfiniteCoins()">üí∞ Infinite Coins</button>
    <button onclick="adminGetLava()">üî• Get Lava Car</button>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    let state = { coins:0, unlocked:["red"], selectedCar:"red", name:"Player" };
    let cars = [
      {id:"red", color:"red", cost:0},
      {id:"blue", color:"blue", cost:100},
      {id:"green", color:"green", cost:200},
      {id:"crystal", color:"lightblue", cost:100},
      {id:"lava", color:"orange", cost:500},
      {id:"admin", color:"gold", cost:0}
    ];
    let adminCarImg = new Image();
    adminCarImg.src = "https://i.imgur.com/8K5Yz1p.png"; 

    // Long English words list
    let wordList = [
      "extraordinary","magnificent","unbelievable","astonishing",
      "imagination","illumination","grandiosity","encyclopedia",
      "fantastical","overwhelming","perpendicular","hallucination"
    ];
    let phrases = [];
    let playerX=0, botX=0, finish=700, raceOver=false, flameParticles=[], crystalParticles=[];

    function save(){ localStorage.setItem("typerace", JSON.stringify(state)); }
    function load(){
      let s=localStorage.getItem("typerace");
      if(s) state=JSON.parse(s);
      $("coins").textContent="Coins: "+state.coins;
      checkAdminPanel();
    }
    function saveName(){
      state.name=$("nameInput").value.trim()||"Player";
      save();
      alert("Name saved!");
      checkAdminPanel();
    }
    function checkAdminPanel(){
      if(state.name==="SupaRed"){ $("adminPanel").style.display="block"; }
      else $("adminPanel").style.display="none";
    }

    function showGarage(){
      $("menu").style.display="none"; $("garage").style.display="block";
      let div=$("carOptions"); div.innerHTML="";
      cars.forEach(car=>{
        let c=document.createElement("div"); c.className="garage-car";
        if(car.id===state.selectedCar) c.classList.add("selected");
        if(car.id==="admin"){
          let img=document.createElement("img"); img.src=adminCarImg.src; img.width=60; img.height=30;
          if(state.name!=="ownedkid"){ img.style.filter="grayscale(100%) opacity(60%)"; c.appendChild(img); }
          else { c.appendChild(img); c.onclick=()=>{state.selectedCar=car.id;save();showGarage();}; }
        } else if(state.unlocked.includes(car.id)){
          c.style.background=car.color;
          c.onclick=()=>{state.selectedCar=car.id;save();showGarage();};
        }
        div.appendChild(c);
      });
    }
    function showShop(){
      $("menu").style.display="none"; $("shop").style.display="block";
      let div=$("shopOptions"); div.innerHTML="";
      cars.forEach(car=>{
        if(!state.unlocked.includes(car.id)&&car.id!=="admin"){
          let b=document.createElement("button");
          b.textContent=car.color+" car - "+car.cost+" coins";
          b.onclick=()=>{
            if(state.coins>=car.cost){ state.coins-=car.cost; state.unlocked.push(car.id); save(); showShop(); $("coins").textContent="Coins: "+state.coins; }
            else alert("Not enough coins");
          };
          div.appendChild(b);
        }
      });
    }
    function backToMenu(){ $("garage").style.display="none"; $("shop").style.display="none"; $("menu").style.display="block"; }
    function startRace(){
      $("menu").style.display="none"; $("race").style.display="block";
      $("typeInput").value=""; $("result").textContent=""; $("returnBtn").style.display="none";
      playerX=0; botX=0; raceOver=false; flameParticles=[]; crystalParticles=[];
      phrases=[wordList[Math.floor(Math.random()*wordList.length)], wordList[Math.floor(Math.random()*wordList.length)]];
      $("phrase").textContent=phrases.join(" ");
      draw(); botRace();
    }
    function checkTyping(){
      if(raceOver) return;
      if($("typeInput").value.trim()===phrases.join(" ")){
        playerX=finish-60; draw();
        $("result").textContent="You Win! üéâ";
        state.coins+=50; $("coins").textContent="Coins: "+state.coins; save();
        raceOver=true; $("returnBtn").style.display="inline-block";
      }
    }
    function botRace(){
      let botIndex=0;
      function step(){
        if(raceOver) return;
        if(botIndex<phrases.length){
          botX+=300; botIndex++; draw();
          if(botIndex===phrases.length){ $("result").textContent="Bot finished! üò¢"; raceOver=true; $("returnBtn").style.display="inline-block"; return; }
          let delay=6000+phrases[botIndex-1].length*500+Math.random()*3000;
          setTimeout(step,delay);
        }
      }
      setTimeout(step,5000);
    }
    function draw(){
      let ctx=$("gameCanvas").getContext("2d");
      ctx.clearRect(0,0,800,400);
      ctx.fillStyle="gray"; ctx.fillRect(0,150,800,100);
      let car=cars.find(c=>c.id===state.selectedCar);

      if(car&&car.id==="lava"){
        // üî• Lava flames
        flameParticles.push({x:playerX-5,y:175,radius:Math.random()*5+3,color:["orange","red","yellow"][Math.floor(Math.random()*3)],alpha:1,decay:0.02});
        for(let p of flameParticles){
          ctx.beginPath(); ctx.arc(p.x,p.y+(Math.random()*20-10),p.radius,0,Math.PI*2);
          ctx.fillStyle=p.color; ctx.globalAlpha=p.alpha; ctx.fill(); ctx.globalAlpha=1;
          p.x-=1; p.alpha-=p.decay;
        }
        flameParticles=flameParticles.filter(p=>p.alpha>0);
        ctx.fillStyle=car.color; ctx.fillRect(playerX,160,60,30);
      } 
      else if(car&&car.id==="crystal"){
        // ‚ùÑ Crystal sparkles
        crystalParticles.push({x:playerX-5,y:175,radius:Math.random()*4+2,color:["lightblue","cyan","white"][Math.floor(Math.random()*3)],alpha:1,decay:0.02});
        for(let p of crystalParticles){
          ctx.beginPath(); ctx.arc(p.x,p.y+(Math.random()*20-10),p.radius,0,Math.PI*2);
          ctx.fillStyle=p.color; ctx.globalAlpha=p.alpha; ctx.fill(); ctx.globalAlpha=1;
          p.x-=0.5; p.alpha-=p.decay;
        }
        crystalParticles=crystalParticles.filter(p=>p.alpha>0);
        ctx.fillStyle=car.color; ctx.fillRect(playerX,160,60,30);
      }
      else if(car&&car.id==="admin"&&state.name==="ownedkid"){ ctx.drawImage(adminCarImg,playerX,160,60,30); }
      else if(car){ ctx.fillStyle=car.color; ctx.fillRect(playerX,160,60,30); }

      ctx.fillStyle="purple"; ctx.fillRect(botX,200,60,30);
      ctx.fillStyle="black"; ctx.fillRect(finish,150,10,100);
    }
    function returnToMenu(){ $("race").style.display="none"; $("menu").style.display="block"; $("returnBtn").style.display="none"; playerX=0; botX=0; flameParticles=[]; crystalParticles=[]; }

    // Admin Functions
    function adminWinRace(){ if(!raceOver){ playerX=finish-60; $("result").textContent="Admin Win! üéâ"; state.coins+=50; save(); raceOver=true; draw(); $("returnBtn").style.display="inline-block"; } }
    function adminUnlockCars(){ state.unlocked=cars.map(c=>c.id); save(); alert("All cars unlocked!"); }
    function adminInfiniteCoins(){ state.coins=999999; save(); $("coins").textContent="Coins: "+state.coins; alert("Infinite coins activated!"); }
    function adminGetLava(){ if(!state.unlocked.includes("lava")){ state.unlocked.push("lava"); save(); alert("Lava Car unlocked!"); } }

    window.onload=()=>{ load(); $("menu").style.display="block"; };
  </script>
</body>
</html>
