<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Speed Type</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    h1 { font-size: 2.5em; margin-top: 20px; }
    .hidden { display: none; }
    canvas { border: 2px solid black; margin-top: 20px; background: white; }
    button { margin: 10px; padding: 10px 20px; font-size: 16px; cursor: pointer; }
    .garage-car { width: 60px; height: 30px; display: inline-block; margin: 10px; border: 2px solid black; cursor: pointer; }
    .selected { border: 4px solid gold; }
    .shop-car { display: inline-block; margin: 10px; text-align: center; }
    .shop-car img { width: 60px; height: 30px; display: block; margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>üèéÔ∏è Speed Type üèÅ</h1>

  <!-- Menu -->
  <div id="menu">
    <button onclick="showGarage()">Garage</button>
    <button onclick="showShop()">Shop</button>
    <button onclick="startGame()">Start Race</button>
    <div style="margin-top:20px;">
      <input type="text" id="playerName" placeholder="Enter your name">
      <button onclick="setProfile()">Set Profile</button>
    </div>
    <p id="profileDisplay">Profile: Guest</p>
    <p>Coins: <span id="coinDisplay">0</span></p>
  </div>

  <!-- Garage -->
  <div id="garage" class="hidden">
    <h2>Garage</h2>
    <div id="carOptions"></div>
    <button onclick="backToMenu()">Back</button>
  </div>

  <!-- Shop -->
  <div id="shop" class="hidden">
    <h2>Shop</h2>
    <div id="shopOptions"></div>
    <button onclick="backToMenu()">Back</button>
  </div>

  <!-- Game -->
  <div id="game" class="hidden">
    <canvas id="gameCanvas" width="600" height="300"></canvas>
    <p>Type this word: <span id="wordDisplay"></span></p>
    <input type="text" id="inputBox" placeholder="Type here">
    <p id="result"></p>
    <button onclick="backToMenu()">Back to Menu</button>
  </div>

  <script>
    let profile = "Guest";
    let coins = 0;
    let selectedCar = "blue";
    let unlockedCars = ["blue", "red"];
    let word = "";
    let playerX = 50;
    let botX = 50;
    const finish = 500;
    const words = ["fast", "speed", "car", "drive", "nitro"];
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // preload admin car
    const adminCarImg = new Image();
    adminCarImg.src = "A_2D_digital_illustration_displays_a_top-down_view.png";

    const cars = [
      { id: "blue", color: "blue", price: 0 },
      { id: "red", color: "red", price: 0 },
      { id: "green", color: "green", price: 50 },
      { id: "yellow", color: "yellow", price: 75 },
      { id: "purple", color: "purple", price: 100 },
      { id: "black", color: "black", price: 150 },
      { id: "white", color: "white", price: 200 },
      { id: "admin", color: "special", price: 0 } // only unlocked by ownedkid
    ];

    function setProfile() {
      const name = document.getElementById("playerName").value.trim();
      if (name) profile = name;
      document.getElementById("profileDisplay").innerText = "Profile: " + profile;
      updateCoins();
    }

    function updateCoins() {
      document.getElementById("coinDisplay").innerText = coins;
    }

    function showGarage() {
      document.getElementById("menu").classList.add("hidden");
      document.getElementById("garage").classList.remove("hidden");
      const div = document.getElementById("carOptions");
      div.innerHTML = "";
      cars.forEach(car => {
        if (unlockedCars.includes(car.id) || (car.id==="admin" && profile==="ownedkid")) {
          let c = document.createElement("div");
          c.className = "garage-car";
          if (car.id === selectedCar) c.classList.add("selected");
          if (car.id === "admin") {
            c.innerHTML = "<img src='"+adminCarImg.src+"' width='60' height='30'>";
          } else {
            c.style.background = car.color;
          }
          c.onclick = () => { selectedCar = car.id; showGarage(); };
          div.appendChild(c);
        }
      });
    }

    function showShop() {
      document.getElementById("menu").classList.add("hidden");
      document.getElementById("shop").classList.remove("hidden");
      const div = document.getElementById("shopOptions");
      div.innerHTML = "";
      cars.forEach(car => {
        if (!unlockedCars.includes(car.id) && car.id!=="admin") {
          let c = document.createElement("div");
          c.className = "shop-car";
          c.innerHTML = "<div style='width:60px;height:30px;background:"+car.color+";border:2px solid black;'></div>";
          c.innerHTML += "<p>"+car.id+" - "+car.price+" coins</p>";
          let btn = document.createElement("button");
          btn.innerText = "Buy";
          btn.onclick = () => {
            if (coins >= car.price) {
              coins -= car.price;
              unlockedCars.push(car.id);
              updateCoins();
              showShop();
            } else {
              alert("Not enough coins!");
            }
          };
          c.appendChild(btn);
          div.appendChild(c);
        }
      });
    }

    function backToMenu() {
      document.getElementById("garage").classList.add("hidden");
      document.getElementById("shop").classList.add("hidden");
      document.getElementById("game").classList.add("hidden");
      document.getElementById("menu").classList.remove("hidden");
      updateCoins();
    }

    function startGame() {
      document.getElementById("menu").classList.add("hidden");
      document.getElementById("game").classList.remove("hidden");
      resetGame();
    }

    function resetGame() {
      word = words[Math.floor(Math.random()*words.length)];
      document.getElementById("wordDisplay").innerText = word;
      document.getElementById("inputBox").value = "";
      document.getElementById("result").innerText = "";
      playerX = 50;
      botX = 50;
      draw();
    }

    document.getElementById("inputBox").addEventListener("input", () => {
      if (document.getElementById("inputBox").value === word) {
        playerX += 50;
        document.getElementById("inputBox").value = "";
        word = words[Math.floor(Math.random()*words.length)];
        document.getElementById("wordDisplay").innerText = word;
        if (playerX >= finish) {
          document.getElementById("result").innerText = "You win!";
          coins += 20; // earn coins
          updateCoins();
          return;
        }
      }
    });

    function botMove() {
      botX += Math.random() * 15;
      if (botX >= finish) {
        document.getElementById("result").innerText = "Player wins!";
      }
    }

    setInterval(() => {
      if (!document.getElementById("game").classList.contains("hidden")) {
        botMove();
        draw();
      }
    }, 800);

    function draw() {
      ctx.clearRect(0,0,600,300);

      // player car
      if (selectedCar === "admin" && profile === "ownedkid") {
        ctx.drawImage(adminCarImg, playerX, 80, 80, 40);
      } else {
        ctx.fillStyle = cars.find(c=>c.id===selectedCar)?.color || "blue";
        ctx.fillRect(playerX, 100, 40, 20);
      }

      // bot car
      ctx.fillStyle = "red";
      ctx.fillRect(botX, 150, 40, 20);

      // finish line
      ctx.fillStyle = "black";
      ctx.fillRect(finish, 0, 5, 300);
    }
  </script>
</body>
</html>
